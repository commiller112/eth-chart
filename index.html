<!DOCTYPE html>
<html>
  <head>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <style>
      html, body, #chart { margin: 0; height: 100%; background-color: #000; }
    </style>
  </head>
  <body>
    <div id="chart"></div>
    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const interval = urlParams.get("interval") || "60";

      const chart = LightweightCharts.createChart(document.getElementById('chart'), {
        width: 800,
        height: 600,
        layout: { background: { color: "#000" }, textColor: "#ccc" },
      });

      const candleSeries = chart.addCandlestickSeries();

      const daysMap = {
        "5": "1",
        "15": "1",
        "60": "1",
        "240": "2",
        "D": "7"
      };

      const days = daysMap[interval] || "1";

      fetch(`https://api.coingecko.com/api/v3/coins/ethereum/market_chart?vs_currency=usd&days=${days}&interval=hourly`)
        .then(res => res.json())
        .then(data => {
          const prices = data.prices.map(p => ({
            time: Math.floor(p[0] / 1000),
            open: p[1],
            high: p[1],
            low: p[1],
            close: p[1]
          }));
          candleSeries.setData(prices);
        });
    </script>
  </body>
</html>
